<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Display a map with a custom style</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.js"></script>
<style>
body, html { margin: 0; padding: 0; height: 100%; width: 100%; }
#map { position: absolute; top: 0; bottom: 0; width: 100%; height:100%;}
</style>
</head>
<body>
<div id="map"></div>
  
<script>
    mapboxgl.accessToken = 'pk.eyJ1IjoidG91c2VlZnlvdW5hcyIsImEiOiJjbHNnajllcTExbmtiMmxzYjM2YnBxa3U0In0.Q9H6YygAJWXVQiQ0QAU-UQ';
    const map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/touseefyounas/clsgly3o503h301qq3y5vgpls',
        center: [-74.0060,40.7128],
        zoom: 9
    });

    map.addControl(new mapboxgl.NavigationControl());

        map.on('moveend', function() {
        var center = map.getCenter();
        var zoom = map.getZoom();
        var bearing = map.getBearing();
        var pitch = map.getPitch();

        window.parent.postMessage({
            type: "mapMoved", 
            coordinates: center, 
            zoomlevel: zoom, 
            direction: bearing,
            pitch: pitch
        }, "*");

    });

    window.addEventListener('message', function(event) {
        if (event.data.type === "setCordinates") {
            map.flyTo({
                center: [event.data.lon, event.data.lat],
                essential: true
            });
        } else if (event.data.type === "syncCenter"){
          map.jumpTo({
                center: [event.data.lon, event.data.lat],
          		pitch: event.data.pitch,
          		zoom: event.data.zoom,
          		bearing: event.data.direction});
        } else if (event.data.type === "style") {
            map.setStyle(event.data.styleURL);
        }
    });
</script>
</body>
</html>